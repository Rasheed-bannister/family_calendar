{% block calendar_content %}
<div id="main-calendar-area">
    <div class="calendar-header-nav">
        <h1 class="family-title">{{ family_name }}</h1>
        <h2 class="month-title">{{ month_name }} {{ year }}</h2>
        <div class="calendar-navigation">
            <button id="qr-btn" class="nav-btn qr-btn" title="Get QR code for photo upload">
                ðŸ“± Photos
            </button>
            <button id="date-picker-btn" class="nav-btn date-picker-btn" title="Jump to date">
                ðŸ“… Change Date
            </button>
            <button id="today-btn" class="nav-btn today-btn" title="Go to today">Today</button>
        </div>
    </div>
    
    <!-- QR Code Modal -->
    <div id="qr-modal" class="qr-modal" style="display: none;">
        <div class="qr-modal-content">
            <button class="qr-close-btn">&times;</button>
            <h3>ðŸ“± Upload Photos from Your Phone</h3>
            <p>Scan this QR code with your phone's camera to upload photos</p>
            <div id="qr-code-container">
                <div class="qr-loading">Generating QR code...</div>
            </div>
            <div id="qr-url" class="qr-url"></div>
            <p class="qr-instructions">
                <small>Make sure your phone is connected to the same Wi-Fi network</small>
            </p>
        </div>
    </div>
    
    <!-- Date Picker Modal -->
    <div id="date-picker-modal" class="date-picker-modal" style="display: none;">
        <div class="date-picker-content">
            <h3>Jump to Date</h3>
            <div class="date-picker-controls">
                <select id="month-select">
                    {% for i in range(1, 13) %}
                    <option value="{{ i }}" {% if i == month_number %}selected{% endif %}>
                        {{ [None, 'January', 'February', 'March', 'April', 'May', 'June', 
                             'July', 'August', 'September', 'October', 'November', 'December'][i] }}
                    </option>
                    {% endfor %}
                </select>
                <select id="year-select">
                    {% for year_option in range(year - 5, year + 6) %}
                    <option value="{{ year_option }}" {% if year_option == year %}selected{% endif %}>{{ year_option }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="date-picker-buttons">
                <button id="date-picker-cancel" class="btn btn-secondary">Cancel</button>
                <button id="date-picker-go" class="btn btn-primary">Go</button>
            </div>
        </div>
    </div>
    <div class="calendar-container">
        <table class="calendar" data-month="{{ month_number }}" data-year="{{ year }}">
            <thead>
                <tr>
                    <th>Sun</th>
                    <th>Mon</th>
                    <th>Tue</th>
                    <th>Wed</th>
                    <th>Thu</th>
                    <th>Fri</th>
                    <th>Sat</th>
                </tr>
            </thead>
            <tbody>
                {% for week in weeks %}
                <tr>
                    {% for day in week %}
                    <td 
                        class="{{ 'current-month' if day.is_current_month else 'other-month' }}" 
                        {% if day.is_current_month %}
                        data-day="{{ day.day_number }}" 
                        data-month="{{ month_number }}" 
                        data-year="{{ year }}"
                        {% endif %}
                    >
                        <div class="day-content"> 
                            <div class="day-header">{{ day.day_number }}</div>
                            <div class="events">
                                {% for event in day.events %}
                                <div class="event"
                                     style="background-color: {{ event.calendar_color or '#eee' }}; border-left: 3px solid {{ event.calendar_color or '#ccc' }};"
                                     data-title="{{ event.title }}"
                                     data-calendar-name="{{ event.calendar_name }}"
                                     data-all-day="{{ 'true' if event.all_day else 'false' }}"
                                     data-start-time="{{ event.start_datetime.strftime('%I:%M %p') if not event.all_day else '' }}"
                                     data-end-time="{{ event.end_datetime.strftime('%I:%M %p') if not event.all_day else '' }}"
                                     data-location="{{ event.location or '' }}"
                                     data-description="{{ event.description or '' }}"
                                     data-color="{{ event.calendar_color or '#ccc' }}">
                                    <span class="event-time">
                                        {% if event.all_day %}
                                            All Day
                                        {% else %}
                                            {{ event.start_datetime.strftime('%-I:%M%p') }}
                                        {% endif %}
                                    </span>
                                    <span class="event-title">{{ event.title }}</span>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                    </td>
                    {% endfor %}
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}